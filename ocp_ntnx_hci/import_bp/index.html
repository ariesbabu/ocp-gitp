<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-ocp_ntnx_hci/import_bp" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">Architecture and Initial Setup | OCP on Nutanix HCI</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://ocp.howntnx.win/ocp_ntnx_hci/import_bp"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Architecture and Initial Setup | OCP on Nutanix HCI"><meta data-rh="true" name="description" content="In this lab, we will set up OCP infrastructure using Nutanix Calm."><meta data-rh="true" property="og:description" content="In this lab, we will set up OCP infrastructure using Nutanix Calm."><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://ocp.howntnx.win/ocp_ntnx_hci/import_bp"><link data-rh="true" rel="alternate" href="https://ocp.howntnx.win/ocp_ntnx_hci/import_bp" hreflang="en"><link data-rh="true" rel="alternate" href="https://ocp.howntnx.win/ocp_ntnx_hci/import_bp" hreflang="x-default"><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="OCP on Nutanix HCI RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="OCP on Nutanix HCI Atom Feed"><link rel="stylesheet" href="/assets/css/styles.6e0c5a85.css">
<link rel="preload" href="/assets/js/runtime~main.7903d261.js" as="script">
<link rel="preload" href="/assets/js/main.2d37a55a.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function e(e){document.documentElement.setAttribute("data-theme",e)}var t=function(){var e=null;try{e=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(e){}return e}()||function(){var e=null;try{e=localStorage.getItem("theme")}catch(e){}return e}();null!==t?e(t):window.matchMedia("(prefers-color-scheme: dark)").matches?e("dark"):(window.matchMedia("(prefers-color-scheme: light)").matches,e("light"))}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="OCP on Nutanix Bootcamp" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.svg" alt="OCP on Nutanix Bootcamp" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">OCP on Nutanix Bootcamp</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ariesbabu/ocp-gitp" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><main class="docMainContainer_gTbr docMainContainerEnhanced_Uz_u"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><h1>OCP: Architecture and Initial Setup</h1><p>In this lab, we will set up OCP infrastructure using Nutanix Calm.</p><p>Calm provides an easy way of provisioning and configuring repeatable
infrastructure. Once the blueprint is developed, it can be used
repeatedly and constantly improved.</p><p>As OCP infrastructure requirements consist of many moving parts, it is
easy to manage the soltuion in Calm. Since Calm can be used to deploy
the same infrastructure accross multiple clouds, it is a optimal
solution to manage the lifecycle of OCP infrastructure.</p><p>At a high-level OCP consists of the following components:</p><ol><li>Boostrap VM</li><li>Stacked Master Nodes (Kubernetes Master + ETCD)</li><li>Worker Nodes (used to run user workloads)</li><li>Infra Nodes (used to run infrastructure based workloads)</li></ol><p><img loading="lazy" src="/assets/images/ocp_infra-caa612e9f1cee03a77856956ea9b34d8.png" width="1472" height="928" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="minimum-hardware-requirements-for-ocp-vms">Minimum Hardware Requirements for OCP VMs<a href="#minimum-hardware-requirements-for-ocp-vms" class="hash-link" aria-label="Direct link to Minimum Hardware Requirements for OCP VMs" title="Direct link to Minimum Hardware Requirements for OCP VMs">​</a></h2><p>These are minimum required resrouces and software for the OCP VMs at the
time of writing this bootcamp.</p><p>The Calm blueprints in this lab will have these resources pre-configured
for your use.</p><p>For latest resource requirements refer to OpenShift portal
<a href="https://docs.openshift.com/container-platform/4.9/installing/installing_platform_agnostic/installing-platform-agnostic.html#installation-minimum-resource-requirements_installing-platform-agnostic" target="_blank" rel="noopener noreferrer">here.</a></p><table><thead><tr><th>OCP Role</th><th>Operating System</th><th>vCPU</th><th>RAM(minimum)</th><th>Storage</th><th>IOPS</th></tr></thead><tbody><tr><td>Bootstrap</td><td>RHCOS</td><td>4</td><td>16 GB</td><td>120 GB</td><td>300</td></tr><tr><td>Master</td><td>RHCOS</td><td>4</td><td>16 GB</td><td>120 GB</td><td>300</td></tr><tr><td>Worker</td><td>RHCOS, RHEL 7.9, or  RHEL 8.4</td><td>8</td><td>16 GB</td><td>120 GB</td><td>300</td></tr></tbody></table><p>We will use two Calm blueprints to deploy OCP infrastructure.</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>These Calm blueprints are developed by Nutanix&#x27;s very own SA <strong>Wolfgang Huse</strong> and team. For updates and more information about these blueprints check this github page <a href="https://github.com/nutanix/openshift/tree/calm-automation/automation/calm" target="_blank" rel="noopener noreferrer">here.</a></p><p>This lab uses a modified version of these blueprints to suit HPOC/SPOC environment and to achieve the learning objectives.</p></div></div><ol><li>Blueprint 1 - provisions a OCP provisioning VM with Calm action to
deploy OCP</li><li>Blueprint 2 - is called by a Calm action in <code>Blueprint 1</code> with all the necessary information that <code>Blueprint 2</code> needs to run</li></ol><p><img loading="lazy" src="/assets/images/ocp_bp_actions-ed86c5047179f4722ec8c710c5769ea1.png" width="1930" height="826" class="img_ev3q"></p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="pre-requisites-for-infrastructure-in-hpocspoc-clusters">Pre-requisites for Infrastructure in HPOC/SPOC Clusters<a href="#pre-requisites-for-infrastructure-in-hpocspoc-clusters" class="hash-link" aria-label="Direct link to Pre-requisites for Infrastructure in HPOC/SPOC Clusters" title="Direct link to Pre-requisites for Infrastructure in HPOC/SPOC Clusters">​</a></h2><p>Since we will be doing the OCP labs in Nutanix HPOC/SPOC clusters, here
is a list of pre-requisites and HPOC/SPOC components that fulfill them.</p><p>Some are created with your HPOC/SPOC cluster runbook (see screenshot
below) you chose while booking the cluster in <a href="https://rx.corp.nutanix.com/" target="_blank" rel="noopener noreferrer">RX</a> .</p><p><img loading="lazy" src="/assets/images/ocp_runbook-2cbd1f0ce8c5d1f6000f05ba3951bdd8.png" width="661" height="178" class="img_ev3q"></p><table><thead><tr><th>OCP Pre-requisite</th><th>HPOC Component</th><th>Status</th></tr></thead><tbody><tr><td>IPAM Enabled</td><td>Primary Network</td><td>Deployed with HPOC Subnet</td></tr><tr><td>Existing AD and</td><td>AutoAD (Active Directory + DNS server)</td><td>Deployed with HPOC</td></tr><tr><td>Calm Project</td><td>BootcampInfra</td><td>Deployed with HPOC</td></tr><tr><td>VM Boot images</td><td>CentOS, RHCOS, etc.</td><td>Deployed with HPOC(downloadable images)</td></tr><tr><td>DNS Entries Update Mechanism</td><td>Calm Endpoint to contact  AutoAD+DNS server</td><td>You will create this using Calm blueprint</td></tr></tbody></table><p>Now we can proceed to setup pre-requistes and deploying blueprints.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="confirm-ncmcalm-endpoint">Confirm NCM/Calm Endpoint<a href="#confirm-ncmcalm-endpoint" class="hash-link" aria-label="Direct link to Confirm NCM/Calm Endpoint" title="Direct link to Confirm NCM/Calm Endpoint">​</a></h2><p>Let&#x27;s ensure that an endpoint exists for creation of DNS entries. </p><p>This endpoint point to the AutoAD <code>Active Directory</code> (AD) server which has DNS role installed. This AD server and NCM endpoint are pre-deployed in your HPOC cluster. </p><ol><li><p>In <strong>Prism Central</strong> &gt; <strong>Services</strong> &gt; <strong>Calm</strong></p></li><li><p>Click on <strong>Endpoint</strong></p></li><li><p>Click on <strong>autoad</strong> endpoint </p></li><li><p>Make sure the IP addresses is pointing to your AD server</p></li></ol><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>If this NCM Endpoint is not pointing to you AD server, let your lab instructor know and they will help you resolve the issue.</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="upload-blueprints">Upload Blueprints<a href="#upload-blueprints" class="hash-link" aria-label="Direct link to Upload Blueprints" title="Direct link to Upload Blueprints">​</a></h2><ol><li><p>Download blueprint1 by right-clicking on this link <a href="https://raw.githubusercontent.com/nutanix-japan/ocp-gitp/main/docs/ocp_ntnx_hci/XYZ_OCP_Prov_VM.json" target="_blank" rel="noopener noreferrer">Provisioning VM</a> and choosing <strong>Download Linked File as</strong> option. Save it as <code>ocpuserXX_OCP_Prov_VM.json</code>.</p></li><li><p>Download blueprint2 by right-clicking on this link <a href="https://raw.githubusercontent.com/nutanix-japan/ocp-gitp/main/docs/ocp_ntnx_hci/XYZ_OCP_Master_Worker.json" target="_blank" rel="noopener noreferrer">OCP Master Worker</a> and choosing <strong>Download Linked File as</strong> option.  Save it as <code>ocpuserXX_OCP_Master_Worker.json</code>.</p></li><li><p>In <strong>Prism Central</strong> &gt; <strong>Services</strong> &gt; <strong>Calm</strong></p></li><li><p>Click on <strong>Blueprints</strong></p></li><li><p>Select <strong>Upload Blueprints</strong> </p></li><li><p>Select your Provisioning VM Initials_OCP_Prov_VM.json blueprint</p></li><li><p>Fill the following Details</p><ul><li><strong>Blueprint Name</strong> - ocpuserXX_OCP_Prov_VM (E.g. ocpuser01_OCP_Prov_VM)</li><li><strong>Project</strong> - BootcampInfra</li></ul><p><img loading="lazy" src="/assets/images/ocp_upload_bp-a6f9b79ad539d9355085713f70c58a53.png" width="478" height="250" class="img_ev3q"></p></li><li><p>Click on <strong>Upload</strong></p></li><li><p>Return to <strong>Blueprints</strong> and upload OC Master Worker
Initials_OCP_Master_Worker.json blueprint</p><ul><li><strong>Blueprint Name</strong> - ocpuserXX_OCP_Master_Worker (E.g.ocpuser01_OCP_Master_Worker)</li><li><strong>Project</strong> - BootcampInfra </li></ul><p><img loading="lazy" src="/assets/images/ocp_upload_bp_mw-f9d1ae84c72706d71aa286af5264b7c0.png" width="482" height="240" class="img_ev3q"></p></li><li><p>Return to <strong>Blueprints</strong> once again and you will see both blueprints
uploaded to Calm</p><p><img loading="lazy" src="/assets/images/ocp_bp_list-02fd02c8483a3cbefd9444a323d251d6.png" width="756" height="278" class="img_ev3q"></p></li></ol><p>Now that we are setup with all required information. We can proceed to deploying the Provisioning VM and ultimately OCP Cluster in the next sections of the lab.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ariesbabu/ocp-gitp/edit/main/docs/ocp_ntnx_hci/import_bp.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_vwxv"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#minimum-hardware-requirements-for-ocp-vms" class="table-of-contents__link toc-highlight">Minimum Hardware Requirements for OCP VMs</a></li><li><a href="#pre-requisites-for-infrastructure-in-hpocspoc-clusters" class="table-of-contents__link toc-highlight">Pre-requisites for Infrastructure in HPOC/SPOC Clusters</a></li><li><a href="#confirm-ncmcalm-endpoint" class="table-of-contents__link toc-highlight">Confirm NCM/Calm Endpoint</a></li><li><a href="#upload-blueprints" class="table-of-contents__link toc-highlight">Upload Blueprints</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Nutanix. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.7903d261.js"></script>
<script src="/assets/js/main.2d37a55a.js"></script>
</body>
</html>