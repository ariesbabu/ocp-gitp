"use strict";(self.webpackChunkocp_gitp=self.webpackChunkocp_gitp||[]).push([[8931],{5680:(e,t,n)=>{n.d(t,{xA:()=>c,yg:()=>d});var a=n(6540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},g=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=i(e,["components","mdxType","originalType","parentName"]),p=u(n),g=r,d=p["".concat(s,".").concat(g)]||p[g]||m[g]||o;return n?a.createElement(d,l(l({ref:t},c),{},{components:n})):a.createElement(d,l({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,l=new Array(o);l[0]=g;var i={};for(var s in t)hasOwnProperty.call(t,s)&&(i[s]=t[s]);i.originalType=e,i[p]="string"==typeof e?e:r,l[1]=i;for(var u=2;u<o;u++)l[u]=n[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}g.displayName="MDXCreateElement"},9365:(e,t,n)=>{n.d(t,{A:()=>l});var a=n(6540),r=n(53);const o={tabItem:"tabItem_Ymn6"};function l(e){let{children:t,hidden:n,className:l}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.A)(o.tabItem,l),hidden:n},t)}},1470:(e,t,n)=>{n.d(t,{A:()=>O});var a=n(8168),r=n(6540),o=n(53),l=n(3104),i=n(6347),s=n(7485),u=n(1682),c=n(9466);function p(e){return function(e){return r.Children.map(e,(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}(e).map((e=>{let{props:{value:t,label:n,attributes:a,default:r}}=e;return{value:t,label:n,attributes:a,default:r}}))}function m(e){const{values:t,children:n}=e;return(0,r.useMemo)((()=>{const e=t??p(n);return function(e){const t=(0,u.X)(e,((e,t)=>e.value===t.value));if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[t,n])}function g(e){let{value:t,tabValues:n}=e;return n.some((e=>e.value===t))}function d(e){let{queryString:t=!1,groupId:n}=e;const a=(0,i.W6)(),o=function(e){let{queryString:t=!1,groupId:n}=e;if("string"==typeof t)return t;if(!1===t)return null;if(!0===t&&!n)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return n??null}({queryString:t,groupId:n});return[(0,s.aZ)(o),(0,r.useCallback)((e=>{if(!o)return;const t=new URLSearchParams(a.location.search);t.set(o,e),a.replace({...a.location,search:t.toString()})}),[o,a])]}function h(e){const{defaultValue:t,queryString:n=!1,groupId:a}=e,o=m(e),[l,i]=(0,r.useState)((()=>function(e){let{defaultValue:t,tabValues:n}=e;if(0===n.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(t){if(!g({value:t,tabValues:n}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${t}" but none of its children has the corresponding value. Available values are: ${n.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return t}const a=n.find((e=>e.default))??n[0];if(!a)throw new Error("Unexpected error: 0 tabValues");return a.value}({defaultValue:t,tabValues:o}))),[s,u]=d({queryString:n,groupId:a}),[p,h]=function(e){let{groupId:t}=e;const n=function(e){return e?`docusaurus.tab.${e}`:null}(t),[a,o]=(0,c.Dv)(n);return[a,(0,r.useCallback)((e=>{n&&o.set(e)}),[n,o])]}({groupId:a}),f=(()=>{const e=s??p;return g({value:e,tabValues:o})?e:null})();(0,r.useLayoutEffect)((()=>{f&&i(f)}),[f]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!g({value:e,tabValues:o}))throw new Error(`Can't select invalid tab value=${e}`);i(e),u(e),h(e)}),[u,h,o]),tabValues:o}}var f=n(2303);const y={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};function b(e){let{className:t,block:n,selectedValue:i,selectValue:s,tabValues:u}=e;const c=[],{blockElementScrollPositionUntilNextRender:p}=(0,l.a_)(),m=e=>{const t=e.currentTarget,n=c.indexOf(t),a=u[n].value;a!==i&&(p(t),s(a))},g=e=>{let t=null;switch(e.key){case"Enter":m(e);break;case"ArrowRight":{const n=c.indexOf(e.currentTarget)+1;t=c[n]??c[0];break}case"ArrowLeft":{const n=c.indexOf(e.currentTarget)-1;t=c[n]??c[c.length-1];break}}t?.focus()};return r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.A)("tabs",{"tabs--block":n},t)},u.map((e=>{let{value:t,label:n,attributes:l}=e;return r.createElement("li",(0,a.A)({role:"tab",tabIndex:i===t?0:-1,"aria-selected":i===t,key:t,ref:e=>c.push(e),onKeyDown:g,onClick:m},l,{className:(0,o.A)("tabs__item",y.tabItem,l?.className,{"tabs__item--active":i===t})}),n??t)})))}function N(e){let{lazy:t,children:n,selectedValue:a}=e;const o=(Array.isArray(n)?n:[n]).filter(Boolean);if(t){const e=o.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:"margin-top--md"}):null}return r.createElement("div",{className:"margin-top--md"},o.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==a}))))}function w(e){const t=h(e);return r.createElement("div",{className:(0,o.A)("tabs-container",y.tabList)},r.createElement(b,(0,a.A)({},e,t)),r.createElement(N,(0,a.A)({},e,t)))}function O(e){const t=(0,f.A)();return r.createElement(w,(0,a.A)({key:String(t)},e))}},3706:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>i,metadata:()=>u,toc:()=>p});var a=n(8168),r=(n(6540),n(5680)),o=n(1470),l=n(9365);const i={title:"Deploy"},s=void 0,u={unversionedId:"ocp_ipi_install/ocp_ipi_install_cleanup",id:"ocp_ipi_install/ocp_ipi_install_cleanup",title:"Deploy",description:"Deploying OCP Cluster",source:"@site/docs/ocp_ipi_install/ocp_ipi_install_cleanup.md",sourceDirName:"ocp_ipi_install",slug:"/ocp_ipi_install/ocp_ipi_install_cleanup",permalink:"/ocp_ipi_install/ocp_ipi_install_cleanup",draft:!1,editUrl:"https://github.com/ariesbabu/ocp-gitp/edit/main/docs/ocp_ipi_install/ocp_ipi_install_cleanup.md",tags:[],version:"current",frontMatter:{title:"Deploy"},sidebar:"tutorialSidebar",previous:{title:"Create Configuration Manifests",permalink:"/ocp_ipi_install/ocp_ipi_config_file"},next:{title:"Nutanix Objects as Backup Destination",permalink:"/optional_labs/objects_prep"}},c={},p=[{value:"Deploying OCP Cluster",id:"deploying-ocp-cluster",level:2},{value:"Cleanup (optional)",id:"cleanup-optional",level:2}],m={toc:p},g="wrapper";function d(e){let{components:t,...i}=e;return(0,r.yg)(g,(0,a.A)({},m,i,{components:t,mdxType:"MDXLayout"}),(0,r.yg)("h2",{id:"deploying-ocp-cluster"},"Deploying OCP Cluster"),(0,r.yg)("p",null,"This will be simplest part of all, provided you have done everything correctly to this point. "),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Start the installation of OCP cluster by executing the following"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"nohup openshift-install create cluster --log-level=debug &\n")),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash",metastring:'title="Now you can follow the nohup logs to see installation progress"',title:'"Now',you:!0,can:!0,follow:!0,the:!0,nohup:!0,logs:!0,to:!0,see:!0,installation:!0,'progress"':!0},"tail -f nohup.out\n"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"A typical installation flow would look like this"),(0,r.yg)("admonition",{parentName:"li",type:"caution"},(0,r.yg)("p",{parentName:"admonition"},"This steps will take up to 40 minutes.")),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-buttonless",metastring:'{16,18} title="Install output - note the access information to the OCP cluster"',"{16,18}":!0,title:'"Install',output:!0,"-":!0,note:!0,the:!0,access:!0,information:!0,to:!0,OCP:!0,'cluster"':!0},'openshift-install create cluster\n#\nINFO Consuming Master Machines from target directory \nINFO Consuming OpenShift Install (Manifests) from target directory \nINFO Consuming Common Manifests from target directory \nINFO Consuming Openshift Manifests from target directory \nINFO Consuming Worker Machines from target directory \nINFO Creating infrastructure resources...         \nINFO Waiting up to 20m0s (until 8:16AM) for the Kubernetes API at https://api.ocpuser01.ntnxlab.local:6443... \nINFO API v1.24.0+b62823b up                       \nINFO Waiting up to 30m0s (until 8:27AM) for bootstrapping to complete... \nINFO Destroying the bootstrap resources...        \nINFO Waiting up to 40m0s (until 8:49AM) for the cluster at https://api.ocpuser01.ntnxlab.local:6443 to initialize... \nINFO Waiting up to 10m0s (until 8:30AM) for the openshift-console route to be created... \nINFO Install complete!                            \nINFO To access the cluster as the system:admin user when using \'oc\', run \nINFO     export KUBECONFIG=/home/ubuntu/auth/kubeconfig\nINFO Access the OpenShift web-console here: https://console-openshift-console.apps.ocpuser01.ntnxlab.local \nINFO Login to the console with user: "kubeadmin", and password: "xxxx-xxxx-xxxx-xxxx" \nINFO Time elapsed: 27m0s\n'))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Once the installation is done we can access OCP cluster using the following ways:"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-text",metastring:'title="Export your kubeconfig file to env"',title:'"Export',your:!0,kubeconfig:!0,file:!0,to:!0,'env"':!0},"export KUBECONFIG=/home/ubuntu/ocpuserXX/auth/kubeconfig # e.g KUBECONFIG=/home/ubuntu/ocpuser01/auth/kubeconfig\n")),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"oc get nodes\n##\nNAME                     STATUS   ROLES    AGE     VERSION\nocpuser01-6zlwh-master-0       Ready    master   14m   v1.24.0+b62823b\nocpuser01-6zlwh-master-1       Ready    master   14m   v1.24.0+b62823b\nocpuser01-6zlwh-master-2       Ready    master   14m   v1.24.0+b62823b\nocpuser01-6zlwh-worker-czbn7   Ready    worker   14m   v1.24.0+b62823b\nocpuser01-6zlwh-worker-njv66   Ready    worker   14m   v1.24.0+b62823b\nocpuser01-6zlwh-worker-mlgbh   Ready    worker   14m   v1.24.0+b62823b\n"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"For GUI access, use the kubeadmin credentials listed in the ",(0,r.yg)("inlineCode",{parentName:"p"},"nohup.out")," file")),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Add to the hosts file entry on your Mac/PC for accessing OCP UI with the following content:"),(0,r.yg)(o.A,{groupId:"Hosts File",mdxType:"Tabs"},(0,r.yg)(l.A,{value:"Template Hosts File",label:"Template Hosts File",mdxType:"TabItem"},(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"10.x.x.x     pc.ntnxlab.local\n10.x.x.x     console-openshift-console.apps.ocpuser0X.ntnxlab.local\n10.x.x.x     oauth-openshift.apps.ocpuser0X.ntnxlab.local \n"))),(0,r.yg)(l.A,{value:"Example Hosts Filed",label:"Example Hosts File",mdxType:"TabItem"},(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"10.42.18.7      pc.ntnxlab.local\n10.38.18.220    console-openshift-console.apps.ocpuser01.ntnxlab.local\n10.38.18.220    oauth-openshift.apps.ocpuser01.ntnxlab.local \n")))),(0,r.yg)("p",{parentName:"li"},"From your Mac/PC, open Chrome"),(0,r.yg)("p",{parentName:"li"},"Open the following URL"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-url"},"https://console-openshift-console.apps.ocpuser0X.ntnxlab.local\n")),(0,r.yg)("p",{parentName:"li"},(0,r.yg)("img",{src:n(5993).A,width:"1407",height:"626"})),(0,r.yg)("p",{parentName:"li"},"You have successfully installed OCP using IPI."))),(0,r.yg)("admonition",{type:"note"},(0,r.yg)("p",{parentName:"admonition"},"Now that you have finished OCP IPI install, you can move on to the ",(0,r.yg)("strong",{parentName:"p"},"OCP Command Access")," section and then on to workloads section.")),(0,r.yg)("h2",{id:"cleanup-optional"},"Cleanup (optional)"),(0,r.yg)("admonition",{title:"DO NOT Cleanup UNLESS .. ",type:"danger"},(0,r.yg)("p",{parentName:"admonition"},"Cleaning up (deleting) the OCP cluster should be done only in the following circumstances:"),(0,r.yg)("ul",{parentName:"admonition"},(0,r.yg)("li",{parentName:"ul"},"You have finished all the labs."),(0,r.yg)("li",{parentName:"ul"},"You have run into issues deploying OCP cluster and you would like to clean up the resources before redeploying OCP cluster."))),(0,r.yg)("p",null,"Run through the following if you would like to delete the OCP cluster. "),(0,r.yg)("ol",null,(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"In your ",(0,r.yg)("inlineCode",{parentName:"p"},"UserXX-LinuxToolsVM"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Change to you working directory that we created before (if not there already)"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"cd /home/ubuntu/ocpuser01\n"))),(0,r.yg)("li",{parentName:"ol"},(0,r.yg)("p",{parentName:"li"},"Clean up with the following command:"),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-bash"},"openshift-install destroy cluster \n")),(0,r.yg)("pre",{parentName:"li"},(0,r.yg)("code",{parentName:"pre",className:"language-buttonless",metastring:'title="Output"',title:'"Output"'},'INFO Starting deletion of Nutanix infrastructure for Openshift cluster "ocpuser01-6zlwh" \nINFO Virtual machines scheduled to be deleted:    \nINFO - ocpuser01-6zlwh-master-2                         \nINFO - ocpuser01-6zlwh-master-1                         \nINFO - ocpuser01-6zlwh-master-0                         \nINFO - ocpuser01-6zlwh-worker-qzslg                     \nINFO - ocpuser01-6zlwh-worker-xjfk9    \nINFO - ocpuser01-6zlwh-worker-mlgbh                 \nINFO Deleting VM ocpuser01-6zlwh-master-2 with ID d7d5f8ac-6190-4708-93d7-c065f24f658c \nINFO Deleting VM ocpuser01-6zlwh-master-1 with ID 050dca81-be33-4b9f-9868-44853810ea99 \nINFO Deleting VM ocpuser01-6zlwh-master-0 with ID 13adfbae-3b22-443e-88e9-e8e58d2be78e \nINFO Deleting VM ocpuser01-6zlwh-worker-qzslg with ID 93a3efc8-cdc6-4df9-a5d5-0ba420e033ab \nINFO Deleting VM ocpuser01-6zlwh-worker-xjfk9 with ID 056f313e-b426-4ec3-a740-2c2ccd8e83ef\nINFO Deleting VM ocpuser01-6zlwh-worker-mlgbh with ID 056f313e-b426-4ef6-a740-2c2ccd8e83vc \nINFO Deleting image "ocpuser01-6zlwh-rhcos" with UUID "3001064e-46ce-4f62-b8d3-116a24eedf55" \nINFO Deleting category value : shared             \nINFO Deleting category value : owned              \nINFO Deleting category key : kubernetes-io-cluster-ocpuser01-6zlwh \nINFO Time elapsed: 32s   \n')))),(0,r.yg)("p",null,"IPI installation method is simple and consistent to deploy as after the pre-requisites are setup once."),(0,r.yg)("p",null,"Customers can easily deploy as many OCP clusters on Nutanix HCI."))}d.isMDXComponent=!0},5993:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/ipi-installed-cluster-f77dfcb37251b37decfd9f06360571a0.png"}}]);